#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Apr 18 14:18:59 2022

@author: luis
"""

supp_smi_chars = {'C', 'N', 'O', '=', '-', '(', ')', '1', '2', '3', '4'}

# Mass, Charge, sigma [nm], epsilon [kJ/mol], delta [nm]
dict_chgs = {'aua01' : ['[CX4H3]', 'Alkane CH3', 15.03, 0, 0.3607, 0.9989, 0.0216],
             'aua02' : ['[CX4H2;$(C!@C)]', 'Alkane CH2', 14.03, 0, 0.3461,	0.7174,	0.0384],
             'aua03' : ['[CX4H1]', 'Alkane CH1', 13.03, 0, 0.3363,	0.4238,	0.0646],
             'aua04' : ['[CX4;!$(C-[#1])]', 'Alkane C', 12.03, 0, 0.244,	0.1317,	0],
             'aua05' : ['[CX3H2;$(C=[#6])]', 'Alkene CH2', 14.03, 0, 0.348, 0.9237, 0.0295],
             'aua06' : ['[CX3H1;$(C=[#6])]', 'Alkene CH1', 13.02, 0, 0.332, 0.7532, 0.0414],
             'aua07' : ['[CX3;$(C=[#6]);!$(C-[#1])]', 'Alkene C', 12.01, 0, 0.302, 0.5146, 0.0407],
             'aua08' : ['[CX4H2;$(C@C)]', 'Cyclic Alkane CH2', 14.03, 0, 0.3461, 0.7490, 0.0336],
             'aua12' : ['[CX3H1;$(C=O)]', 'Carbonyl CH1', 13.02, 0, 0.332, 0.7532, 0.0414],
             'aua13' : ['[CX3;$(C=O);!$(C-[#1])]', 'Carbonyl C', 12.01, 0, 0.302, 0.5146, 0],
             'aua14' : ['[cX3H1]', 'Aromatic CH1', 13.02, 0, 0.3246, 0.7434, 0.0407],
             'aua15' : ['[cX3;!$([#6]-[#1])]', 'Aromatic C', 12.01, 0, 0.3246, 0.3136, 0],
             'aua21' : ['[OX2H1;$(O-C);!$(O-C=*)]', 'Alcohol O', 16.00, -0.7, 0.3081, 1.0393, 0.001],
             'aua22' : ['[OX2;$(O(C)C);!$(O-C=*)]', 'Ether O', 16.00, 0, 0.2991, 0.4963, 0],
             'aua23' : ['[OX1;$(O=C[#1]);!$(O=CO);!$(O=CN);!$(O=C=*)]', 'Aldehyde O', 16.00, -0.46, 0.2981, 0.8024, 0],
             'aua24' : ['[OX1;!$(O=C[#1]);!$(O=CO);!$(O=CN);!$(O=C=*)]', 'Ketone O', 16.00, -0.49, 0.2981, 0.8024, 0],
             'aua25' : ['[OX1;$(O=CO[#1]);!$(O=CN);!$(O=C=*)]', 'CarboxAcid - Carbonyl O', 16.00, -0.506, 0.2981, 0.8024, 0],
             'aua26' : ['[OX1;$(O=CO[#6]);!$(O=CN);!$(O=C=*)]', 'Ester - Carbonyl O', 16.00, -0.377, 0.2981, 0.8024, 0],
             'aua27' : ['[OX2H1;$(O-C=O)]', 'CarboxAcid O', 16.00, -0.437, 0.3081, 1.0393, 0.001],
             'aua28' : ['[OX2;$(O(C)C=O)]', 'Ester O', 16.00, -0.337, 0.2991, 0.4963, 0],
             'aua29' : ['[#1;$([#1]-O-[CX4])]', 'Alcohol H', 1.008, 0.435, 0, 0, 0],
             'aua30' : ['[#1;$([#1]-O-[CX3])]', 'CarboxAcid H', 1.008, 0.405, 0, 0, 0],
             'aua41' : ['[NX3H2;!$(NC=*);!$(NO)]', 'Amine1 N', 14.007, -0.892, 0.3415, 1.1428, 0.017],
             'aua42' : ['[NX3H1;!$(NC=*);!$(NO)]', 'Amine2 N', 14.007, -0.73, 0.3172, 1.0032, 0.0497],
             'aua43' : ['[NX3;!$(N-[#1]);!$(NC=*);!$(NO)]', 'Amine3 N', 14.007, -0.69, 0.26, 0.3908, 0],
             'aua44' : ['[#1;$([#1]-[NX3H2]-[CX4])]', 'Amine1 H', 1.008, 0.356, 0, 0, 0],
             'aua45' : ['[#1;$([#1]-[NX3H1]-[CX4])]', 'Amine2 H', 1.008, 0.378, 0, 0, 0]
             }

dict_fgs = {'Alkene' : '[CX3]=[CX3]',
            'Aromatic (Benzene-like)' : '[c][c][c][c][c][c]',
            'Alcohol' : '[CX4][OX2;$(O-C);!$(O-C=*)][#1]',
            'Ether' : '[CX4]'+dict_chgs['aua22'][0]+'[CX4]',
            'Aldehyde' : '[CX3]=[OX1;$(O=C[#1]);!$(O=CO);!$(O=CN);!$(O=C=*)]',
            'Ketone' : '[CX3]=[OX1;!$(O=C[#1]);!$(O=CO);!$(O=CN);!$(O=C=*)]',
            'CarboxAcid' : '[CX4][CX3](='+dict_chgs['aua25'][0]+')'+dict_chgs['aua27'][0]+dict_chgs['aua30'][0],
            'Ester' : '[CX4][CX3](='+dict_chgs['aua26'][0]+')'+dict_chgs['aua28'][0]+'[CX4]',
            'Amine1' : '[CX4]'+dict_chgs['aua41'][0]+'('+dict_chgs['aua44'][0]+')'+dict_chgs['aua44'][0],
            'Amine2' : '[CX4]'+dict_chgs['aua42'][0]+'('+dict_chgs['aua45'][0]+')[CX4]',
            'Amine3' : '[CX4]'+dict_chgs['aua43'][0]+'([CX4])[CX4]'
            }

d_abb = {'CHX_alkene' : '[CX3H2&$(C=[#6]),CX3H1&$(C=[#6]),CX3&$(C=[#6])&!$(C-[#1])]'}

bondtypes = {'[CX4][CX4]' : [1, 0.1535, 'CHX-CHX'],
             '[c][c]' : [1, 0.1535, 'AC-AC'],
             '[c][CX4]' : [1, 0.151, 'AC-CHX'], # J. Phys. Chem. B 2004, 108, 14115-14123
            '[CX4][OX2]' : [1, 0.143, 'CHX-O'],
            '[OX2][#1]' : [1, 0.0945, 'O-H'],
            '[CX3]=[CX3]' : [1, 0.1331, 'CHX=CHX'],
            d_abb['CHX_alkene']+'[CX4]' : [1, 0.1535, 'CHX_-CHX'],
            d_abb['CHX_alkene']+d_abb['CHX_alkene'] : [1, 0.1535, 'CHX_-CHX'],
            '[CX4][CX3;$(C=O)]' : [1, 0.1522, 'CHX-C(=O)'],
            '[CX3;$(C=O)][OX2]' : [1, 0.143, 'C(=O)-O'],
            '[CX3]=[OX1]' : [1, 0.1229, 'C=O'],
            '[CX4][NX3;!$(N-[#1])]' : [1, 0.1463, 'CHX-N3'],
            '[CX4][NX3;H1]' : [1, 0.1463, 'CHX-N2'],
            '[CX4][NX3;H2]' : [1, 0.1429, 'CHX-N1'],
            '[NX3][#1]' : [1, 0.101, 'NX-H']
            }

angletypes = {'[CX4][CX4H2][CX4]' : [2, 114.000, 622.719, 'CHX-CH2-CHX'],
              '[CX4][CX4H1][CX4]' : [2, 112.000, 604.428, 'CHX-CH-CHX'],
              '[CX4][CX4;!$(C-[#1])][CX4]' : [2, 109.470, 584.566, 'CHX-C-CHX'],
              '[CX4][CX4][OX2]' : [2, 109.47, 497.177,'CHX-CHX-O(Ether/Alcohol/Ester)'],
              '[CX4][OX2][#1]' : [2, 108.5, 507.154, 'CHX-O-H'],
              '[CX4][CX4H2][CX3;$(C=O)]' : [2, 114.000, 622.719, 'CHX-CH2-C(=O)'],
              '[CX4][CX3;$(C=O)][CX4]' : [2, 119.2, 879.804, 'CHX-C(sp2)(=O)-CHX'],
              '[CX4][CX3]=[O]' : [2, 120.4, 879.804, 'CHX-C=O'],
              '[CX4][CX4H1][O;$(O(C)C)]' : [2, 112, 478.055, 'CHX-CH-O(Ether)'],
              '[CX4][CX4;!$(C-[#1])][O;$(O(C)C)]' : [2, 112, 478.055, 'CHX-C-O(Ether)'],
              '[CX4][O][CX4]' : [2, 112, 573.666, 'CHX-O(Ether)-CHX'],
              '[CX4][CX3;$(C=O)][O]' : [2, 119.2, 879.804, 'CHX-C(sp2)(=O)-O'],
              '[O]=[CX3;$(C-[#6])][O]' : [2, 120.4, 879.804, 'O=C(sp2)(=O)-O'],
              '[CX3;$(C=O)][O][CX4]' : [2, 112, 573.666, 'C(sp2)(=O)-O-CHX'],
              '[CX3;$(C=O)][O][#1]' : [2, 108.5, 507.154, 'C(sp2)(=O)-O-H'],
              '[CX4][NX3][#1]' : [2, 109.5, 329.584, 'CHX-NX-H'],
              '[#1][NX3][#1]' : [2, 106.4, 396.420, 'H-NX-H'],
              '[CX4][CX4][NX3]' : [2, 109.47, 529.020, 'CHX-CHX-NX'],
              '[CX4][NX3H1][CX4]' : [2, 111.000, 474.962, 'CHX-N2-CHX'],
              '[CX4][NX3;!$(N-[#1])][CX4]' : [2, 112.300, 474.962, 'CHX-N3-CHX'],
              '[C][C][c]' : [2, 114.000, 622.719, 'AC-CHX-CHX']}  # J. Phys. Chem. B 2004, 108, 14115-14123

dihtypes = {'[CX4][CX4H2][CX4H2][CX4]' : [3, 8.4398	, 16.1260, -2.0203, -17.4018, 3.5176, -8.9164, 'CHX-CH2-CH2-CHX'],
            '[CX4][CX4H2][CX4H2][CX3;$(C=O);!$(C-[#1])]' : [3, 8.4398, 16.1260, -2.0203, -17.4018, 3.5176, -8.9164, 'CHX-CH2-CH2-C(sp2)(=O)'],
            '[CX4][CX4H2][CX4H2][CX3H1;$(C=O)]' : [3, 8.4398, 16.1260, -2.0203, -17.4018, 3.5176, -8.9164, 'CHX-CH2-CH2-CH(sp2)(=O)'],
            '[CX4][CX4H2][CX3;$(C=O)][CX4H3]' : [3, 3.1015, 7.6409, 2.2294, -14.4432, 0.0000, 0.0000, 'CHX-CH2-C(sp2)(=O)-CH3'],
            '[CX4][CX4H2][CX3;$(C=O);!$(C-O-[#1])]=[O]' : [3, 1.8604	, 9.7522, -0.5165, -17.9901, -0.7554, 7.8728, 'CHX-CH2-C(sp2)(=O)=O(!CarboxAcid)'],
            '[CX4][CX4H2][CX3H1;$(C=O)]=[O]' : [3, 6.4700, 17.2316, 4.5577, 28.1612, 0.0000, 0.0000, 'CHX-CH2-CH(sp2)(=O)=O'],
            '[CX4][CX4H2][CX4H2][O;$(O(C)C)]' : [3, 6.9827, 17.7352, 0.8869, -25.6048, 0.0000, 0.0000, 'CHX-CH2-CH2-O(Ether)'],
            '[CX4][CX4H2][CX4H2][O;$(O-[#1])]' : [3, 6.9827, 17.7352, 0.8869, -25.6048, 0.0000, 0.0000, 'CHX-CH2-CH2-O(Alcohol)'],
            '[CX4][CX4H1][CX4H2][O;$(O-[#1])]' : [3, 6.9827, 17.7352, 0.8869, -25.6048, 0.0000, 0.0000, 'CHX-CH1-CH2-O(Alcohol)'], # Copy form 'CHX-CH2-CH2-O(Alcohol)'
            '[CX4][CX4;!$(C-[#1])][CX4H2][O;$(O-[#1])]' : [3, 6.9827, 17.7352, 0.8869, -25.6048, 0.0000, 0.0000, 'CHX-C-CH2-O(Alcohol)'], # Copy form 'CHX-CH2-CH2-O(Alcohol)'
            '[O;$(O-[#1])][CX4H2][CX4H2][O;$(O-[#1])]' : [3, 13.0109	, 34.1819, -8.2238, -51.1063, 3.5430	, 15.4967, 'O(Alcohol)-CH2-CH2-O(Alcohol)'],
            '[CX4][CX4H2][O][CX4]' : [3, 7.9486, 7.8921, 2.7228, -18.5635, 0.0000, 0.0000, 'CHX-CH2-O(Ether)-CHX'],
            '[CX4][CX4H1][O][CX4]' : [3, 3.1015, 7.6409, 2.2294, -14.4432, 0.0000, 0.0000, 'CHX-CH-O(Ether)-CHX'],
            '[CX4][CX4;!$(C-[#1])][O][CX4]' : [3, 1.9176, 5.7526, 0.0000, -7.6703, 0.0000, 0.0000, 'CHX-C-O(Ether)-CHX'],
            '[O;$(O(C)C)][CX4H2][CX4H2][O;$(O(C)C)]' : [3, 4.9077, 24.2755, 18.0161, -30.7275, -7.5057, 0.4833, 'O(Ether)-CH2-CH2-O(Ether)'],
            '[CX4][CX4H2][OX2H1][#1]' : [3, 2.8219, 2.9429, 0.4850, -6.2498, 0.0000, 0.0000, 'CHX-CH2-O(Alcohol)-H'],
            '[CX4][CX4H1][OX2H1][#1]' : [3, 2.5132, -5.9785, -0.5231, 5.7839, 0.0000, 0.0000, 'CHX-CH1-O(Alcohol)-H'],
            '[CX4][CX4;!$(C-[#1])][OX2H1][#1]' : [3, 1.3598, 4.0795, 0.0000, -5.4394, 0.0000, 0.0000, 'CHX-C-O(Alcohol)-H'],
            '[O;$(O(C)C)][CX4H2][CX4H2][O;$(O-[#1])]' : [3, 12.7222, 33.7903, -3.5150, -46.3106, 0.0000, 0.0000, 'O(Ether)-CH2-CH2-O(Alcohol)'],
            '[CX4][CX4H2][CX3;$(C=O);!$(C-O-[#1])][O;$(O-[#1])]' : [3, 3.1015, 7.6409, 2.2294, -14.4432, 0.0000, 0.0000, 'CHX-CH2-C(sp2)(=O)-O'],
            '[CX4][OX2][CX3;$(C=O)]=[O]' : [3, 53.9296, 14.4148, -34.2371, 5.1015, 0.0000, 0.0000, 'CHX-O-C(sp2)(=O)=O'],
            '[CX4][OX2][CX3;$(C=O)][CX4]' : [3, 54.4675, -13.0206, -34.8855, -6.5614, 0.0000	, 0.0000, 'CHX-O-C(sp2)(=O)-CHX'],
            '[CX4][CX4H2][OX2][CX3;$(C=O)]' : [3, 7.9486, 7.8921, 2.7228, -18.5635, 0.0000, 0.0000, 'CHX-CH2-O-C(sp2)(=O)'],
            '[CX4][CX4][CX3]=[CX3]' : [3, 2.2645, -7.7995, 1.8351, 9.4369, 0.0000, 0.0000, 'CHX-CHX-CH=CH'],
            '[CX4][CX4H2][CX3;$(C=O);$(C-O-[#1])]=[O]' : [3, 18.2276, 5.2378, -12.9898, 0.0000, 0.0000, 0.0000, 'CHX-CH2-C(sp2)(=O)=O(CarboxAcid)'],
            '[CX4][CX4H2][CX3;$(C=O);$(C-O-[#1])][OX2H1]' : [3, 18.2276, -5.2378, -12.9898, 0.0000, 0.0000, 0.0000, 'CHX-CH2-C(sp2)(=O)-O(CarboxAcid)'],
            '[#1][OX2][CX3;$(C=O);$(C-O-[#1])]=[O]' : [3, 18.2276, 5.2378, -12.9898, 0.0000, 0.0000, 0.0000, 'H-O-C(sp2)(=O)=O(CarboxAcid)'],
            '[CX4][CX3;$(C=O);$(C-O-[#1])][OX2][#1]' : [3, 18.2276, -5.2378, -12.9898, 0.0000, 0.0000, 0.0000, 'CHX-C(sp2)(=O)-O(CarboxAcid)-H'],
            '[CX4][CX4H2][NX3][#1]' : [3, 1.4011, 7.3665, 5.5704, -5.9634, -0.7605, -2.8751, 'CHX-CH2-NX-H'],
            '[CX4][CX4H1][NX3][#1]' : [3, 0.5475, 2.0707, 0.9741, -1.6740, -0.3408, -0.7821, 'CHX-CH-NX-H'],
            '[CX4][CX4;!$(C-[#1])][NX3][#1]' : [3, 0.5475, 2.0707, 0.9741, -1.6740, -0.3408, -0.7821, 'CHX-C-NX-H'], # Copy from 'CHX-CH-NX-H'
            '[CX4][CX4H2][NX3;$(N-[#1])][CX4]' : [3, 1.2170, 8.3904, 9.8661, -13.1738, -1.8127, -3.4686, 'CHX-CH2-N2-CHX'],
            '[CX4][CX4H1][NX3;$(N-[#1])][CX4]' : [3, 2.3459, 3.3958, 2.2089, -6.2033, -1.1884, -1.7963, 'CHX-CH-N2-CHX'],
            '[CX4][CX4H2][NX3;!$(N-[#1])][CX4]' : [3, 1.8164, 8.6319, 7.9346, -15.8823, -0.5470, -2.2638, 'CHX-CH2-N3-CHX'],
            '[CX4][CX4H2][CX4H2][NX3]' : [3, 6.8894, 20.7465, -1.4681, -29.0364, 2.3078, 0.4402, 'CHX-CH2-CH2-NX'],
            '[CX4][CX4H1][CX4H2][NX3]' : [3, 4.6942, 10.8058, -3.1891, -14.9471, 2.7578, -0.8728, 'CHX-CH-CH2-NX'],
            '[NX3][CX4H2][CX4H2][NX3]' : [3, 12.1773, 30.2126, -10.2537, -36.3083, 11.8850, -0.8327, 'NX-CH2-CH2-NX'],
            '[CX4H2][CX4H2][CX4H1][NX3]' : [3, 3.6137, 9.5093, 1.2429, -13.8651, 2.0507, -1.6274, 'CH2-CH2-CH-NX'],
            '[O;$(O-[#1])][CX4H2][CX4H2][NX3]' : [3, 3.3343, 38.6527, -38.9679, 4.1409, 64.2887, -43.9548, 'O-CH2-CH2-NX'],
            '[O;$(O-[#1])][CX4H2][CX4H1][NX3]' : [3, 3.3343, 38.6527, -38.9679, 4.1409, 64.2887, -43.9548, 'O-CH2-CH1-NX'], # Copy form 'O-CH2-CH2-NX'
            '[O;$(O-[#1])][CX4H2][CX4;!$(C-[#1])][NX3]' : [3, 3.3343, 38.6527, -38.9679, 4.1409, 64.2887, -43.9548, 'O-CH2-C-NX'], # Copy form 'O-CH2-CH2-NX'
            '[O;$(O-[#1])][CX4H1][CX4H2][NX3]' : [3, 3.3343, 38.6527, -38.9679, 4.1409, 64.2887, -43.9548, 'O-CH-CH2-NX'], # Copy form 'O-CH2-CH2-NX'
}


vsclasf = {'aua01' : '2a',
           'aua02' : '3a',
           'aua03' : 'n&2',
           'aua05' : '2a',
           'aua06' : '3a',
           'aua08' : '3a',
           'aua12' : '3a',
           'aua14' : '3a',
           'aua21' : '2b',
           'aua27' : '2b',
           'aua41' : '3b',
           'aua42' : '2b'}


opt_tops = {'C(CO)N' : 'MEA', # MEA: monoethanol amine
            'C(CO)NCCO' : 'DEA', # DEA: diethanol amine
            'CC(CNCC(C)O)O' : 'DIPA', # DIPA: diisopropyl amine
            'CC(C)(CO)N' : 'AMP', # AMP: 2-amino-2-methyl-1-propanol
            'CN(CCO)CCO' : 'MDEA', # MDEA: methyldiethanolamine
            'C(CO)N(CCO)CCO' : 'TEA'} # TEA: triethanolamine
